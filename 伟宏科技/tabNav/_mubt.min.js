/**
 * Ctrip JavaScript Code
 * http://www.ctrip.com/
 * Copyright(C) 2008 - 2017, Ctrip All rights reserved.
 * Version: 170518
 * Date: 2017-05-18
 */
;!function(t,e,r){function n(t,e){function r(){i.queueCheck(!0,"useraction"),i.queueCheck(!0,"matrix"),i.status.destroyed&&i.status.pv||setTimeout(r,2e3)}if(n._count++,this.status={destroyed:!1,isnewsid:0,isnewvid:0,islogin:0,pvready:!1,pv:!1,ps:!1},this.data={orderid:"",abtest:"",pid:0,vid:"",sid:0,pvid:0,tid:"",ppv:0,ppi:0},this._duser={},this.queue={},this.init(t,e),v||g){this.initUBT()
}else this.readBfa();var i=this;r()}function i(){if(g||_._union_){var t=S.$v("page_id");"wait"==t||(t=S.toint(t),0!=t?S.isReady=!0:"complete"==e.readyState?S.isReady=!0:S.readyMax<=0&&(S.isReady=!0))}else _._union_=!0;return!S.isReady&&S.readyMax>0?(S.readyMax--,void(w=setTimeout(i,500))):C.ready()}function a(t){S.loadScript({onScriptLoad:function(){_._union_=!0,t&&t()
},onScriptError:function(){_._union_=!0}},"//webresource.c-ctrip.com/ResUnionOnline/R7/common/h5Redirect.js")}if(!t.JSON||!t.JSON.parse||!t.JSON.stringify||"undefined"==typeof localStorage)return 0;if(!t.$_bf||t.$_bf.loaded!==!0)try{var o="1.7.8",s=e.documentElement,u=function(){},c=18e5,d={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error","[object Object]":"object"},f=1,p="",l=d.toString,h=d.hasOwnProperty,g=(o.trim,!1),v=!1,m="",y=/\$\{(\w+)\}/g,b=/((test[a-z]?|dev|uat|ui|local)\.sh\.(ctrip|huixuan)travel)|(qa\.nt\.ctripcorp)/i,_={fingerprint:"",domain:"",refer:"",surl:"",href:"",protocol:"",env:"online",lang:"",rerun:2,tcpReady:!1,debug:!1,markting:!0},k=[];
t.$_bf=t.$_bf||{},t.$_bf.version=o,t.$_bf.loaded=!0;var S=function(){function n(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t}function i(t,e,r){if(void 0===e)return t;switch(null==r?3:r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)
};case 4:return function(r,n,i,a){return t.call(e,r,n,i,a)}}return function(){return t.apply(e,arguments)}}var a=navigator,s=screen.colorDepth+"-bit",u=(a.language||a.browserLanguage||"").toLowerCase();_.lang=u,a.userAgent&&a.userAgent.indexOf("CtripWireless")>=0&&(v=!0,new RegExp("_([\\d.]+)$").test(a.userAgent)&&(m=RegExp.$1));
var c=/d{1,4}|m{1,2}|yy(?:yy)?/g,f={version:o,_union_:!1,readyMax:30,isReady:!1,enter:(new Date).getTime(),watchdog:function(){},now:Date.now||function(){return(new Date).getTime()},toint:function(t){return parseInt(t,10)||0},plus:function(t){return f.toint(t)+1},type:function(t){return d[typeof t]||d[l.call(t)]||(t?"object":"null")
},isArray:function(t){return"array"==f.type(t)},isFunction:function(t){return"function"==f.type(t)},isEmpty:function(t){return t===r||"-"==t||""==t},keys:function(t){if(Object.keys)return Object.keys(t);var e=[];for(var r in t)h.call(t,r)&&e.push(r);return e},each:function(t,e,r){e=i(e,r);var n,a;if(f.isArray(t))for(n=0,a=t.length;a>n;n++)e(t[n],n,t);
else{var o=f.keys(t);for(n=0,a=o.length;a>n;n++)e(t[o[n]],o[n],t)}return t},getRand:function(){return(""+Math.random()).slice(-8)},hash:function(t){var e,r=1,n=0;if(!f.isEmpty(t)){for(r=0,e=t.length-1;e>=0;e--)n=t.charCodeAt(e),r=(r<<6&268435455)+n+(n<<14),n=266338304&r,r=0!=n?r^n>>21:r;return r}},getHash:function(){var t=[a.appName,a.appVersion,a.platform,a.userAgent,screen.width+screen.height,s,e.cookie?e.cookie:"",_.refer].join("");
return f.hash(t)},$:function(t){return"string"!=typeof t?!1:e.getElementById(t)},$v:function(t){var e=f.$(t);return e&&e.value||""},send:function(t,e){if("string"!=typeof t)return!1;var r=_.surl+"/bf.gif?",n=new Image;return n.onload=function(){n=n.onload=n.onerror=null,e&&f.isFunction(e)&&e(1)},n.onerror=function(){n=n.onload=n.onerror=null,e&&f.isFunction(e)&&e(0)
},n.src=r+t+"&rd="+S.now()+"&jv="+o,!0},decode:function(t){return decodeURIComponent(t)},encode:function(t){return encodeURIComponent(t)},getCookie:function(t,r,n){var i=new RegExp("(^| )"+t+"=([^;]*)(;|$)"),a=e.cookie.match(i);return a?n?f.decode(a[2]):a[2]:r||""},getCookieObj:function(t,e){var r,n={__k:t},i=[],a=f.getCookie(t,"",e);
if(a){i=a.split("&")||[];for(var o=0;o<i.length;o++)r=i[o].split("="),r.length>1&&(n[r[0]]=r[1])}return n},setCookie:function(t,r,n){var i=_.domain?";domain="+_.domain:"",a=";path=/",o="";if(n>=0){var s=new Date(f.now()+n);o=";expires="+s.toUTCString()}e.cookie=t+"="+f.encode(r)+i+a+o},getItem:function(t,e){var r=localStorage.getItem(t)||"";
if(r&&e)try{r=JSON.parse(r)}catch(n){r=""}return r},setItem:function(t,e){"object"==typeof e&&(e=JSON.stringify(e)),"string"==typeof e&&localStorage.setItem(t,e)},extend:function(){var t,e,n,i,a=arguments[0]||{},o=1,s=arguments.length;for(s===o&&(a=this,--o);s>o;o++)if(null!=(i=arguments[o]))for(n in i)t=a[n],e=i[n],a!==e&&e!==r&&(a[n]=e);
return a},getDateVer:function(t){var e=new Date,r=e.getFullYear(),i=e.getMonth(),a=e.getDate(),o={d:a,dd:n(a,2),m:i+1,mm:n(i+1),yy:e.getYear(),yyyy:r};return t.replace(c,function(t){return o[t]||t})},loadScript:function(t,r){try{t&&t.mask&&(r+="?v="+f.getDateVer(t.mask));var n=e.createElement("script");
n.type="text/javascript",n.charset="utf-8",n.async=!0,n.onload=t.onScriptLoad||null,n.onerror=t.onScriptError||null,n.src=_.protocol+r;var i=e.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i)}catch(a){t&&t.onScriptError&&t.onScriptError()}},uniqueID:function(){return f.getRand()^2147483647&f.getHash()
},grab:function(t,e){var r,n={};switch(e=e||{},n.v=e.v||"",n.w=e.w||"default",n.l=e.l||0,n.t=e.t||"string",n.w){case"input":r=f.$v(t);break;case"cookie":r=f.getCookie(t,n.v);break;case"function":r=f.isFunction(n.v)?n.v():"";break;case"object":default:r=n.v}switch(n.t){case"number":return f.toint(r);case"boolean":return!!r;
default:return n.l?String(r).substring(0,n.l):r}},getTagIndex:function(t,e){var r=0;if("DIV"==e&&(t.attributes["page-url"]||t.getAttribute("page-url")))return"";if(t.parentNode)for(var n=t.parentNode.firstChild;n&&n!=t;)1==n.nodeType&&n.tagName==t.tagName&&r++,n=n.nextSibling;return r>0?"["+ ++r+"]":""
},getXpath:function(t){for(var e,r=[],n=0;t&&9!=t.nodeType;){if(1==t.nodeType){var i=(t.nodeName||"").toUpperCase(),a=i+f.getTagIndex(t,i)+(t.id?"[@id='"+t.id+"']":"");(e=t.getAttribute("data-ubt-key"))&&(a+="[@cid='"+e+"']"),r[n++]=a}t=t.parentNode}return r.reverse().join("/")},getRefer:function(){var r="";
try{r=e&&e.referrer}catch(n){}if(""==r&&t.opener)try{r=t.opener.location.href}catch(n){}return r},notChosen:function(t){var e=C.data.vid;return!e||this.hash(e)%100>(t>>0)-1},initDomin:function(t){if(t=t||location.hostname,/^(\d|\.)+$/.test(t)||"localhost"==t)return t;var e=t.split(".");return e.slice(1).join(".")
},initEnv:function(t){var e="";"file:"==_.protocol?(_.protocol="http:",g=!0):g=!1,e=_.protocol,_.debug===!0?_.surl="http://localhost":"dev"==t?_.surl=e+"//ubt.uat.qa.nt.ctripcorp.com":"test"==t?_.surl=e+"//ubt.uat.qa.nt.ctripcorp.com":"offline"==t?_.surl=e+"//ubt.sh.ctriptravel.com":"uat"==t||b.test(_.href)?_.surl=e+"//ubt.uat.qa.nt.ctripcorp.com":(t="online",_.surl=e+"//s.c-ctrip.com"),_.env=t
},init:function(){var r=t.location||e.location,n=r.hostname;_.protocol=r.protocol,_.domain=f.initDomin(n),_.href=r.href;var i="string"==typeof t.$_bf.env?t.$_bf.env:"online";""!=f.getItem("isPreProduction")&&(i="test"),f.initEnv(i),_.refer=f.getRefer()}};return f.init(),f}();!function(){"use strict";
try{var r={murur_hash:function(t,e){var r,n,i,a,o,s,u,c;for(r=3&t.length,n=t.length-r,i=e||31,o=3432918353,s=461845907,c=0;n>c;)u=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,u=(65535&u)*o+(((u>>>16)*o&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*s+(((u>>>16)*s&65535)<<16)&4294967295,i^=u,i=i<<13|i>>>19,a=5*(65535&i)+((5*(i>>>16)&65535)<<16)&4294967295,i=(65535&a)+27492+(((a>>>16)+58964&65535)<<16);
switch(u=0,r){case 3:u^=(255&t.charCodeAt(c+2))<<16;case 2:u^=(255&t.charCodeAt(c+1))<<8;case 1:u^=255&t.charCodeAt(c),u=(65535&u)*o+(((u>>>16)*o&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*s+(((u>>>16)*s&65535)<<16)&4294967295,i^=u}return i^=t.length,i^=i>>>16,i=2246822507*(65535&i)+((2246822507*(i>>>16)&65535)<<16)&4294967295,i^=i>>>13,i=3266489909*(65535&i)+((3266489909*(i>>>16)&65535)<<16)&4294967295,i^=i>>>16,i>>>0
},display:function(){var t=screen||null,e=[];return t?(e.push(t.width+"x"+t.height+"|"+t.colorDepth),t.deviceYDPI&&e.push("|DPI"+t.deviceXDPI+"x"+t.deviceYDPI),e.join("")):"screen"},timezone:function(){return"zone"+(new Date).getTimezoneOffset()},os:function(){var e=[],r=navigator;return t.maxConnectionsPerServer&&e.push("maxcon"+(t.maxConnectionsPerServer||"0")),r.hardwareConcurrency&&e.push("hdcon"+r.hardwareConcurrency),e.push(this.timezone()),e.push(this.display()),e.join("")
},agent:function(){var t=navigator,e=[];if(t.mimeTypes){for(var r=t.mimeTypes,n=r.length||0,i="",a=0;n>a;a++){var o=r[a];i+=o.type+o.suffixes+o.description}e.push(i)}if(t.plugins){for(var s=t.plugins,u="pls",c=0;c<s.length;c++){var d=s[c];if(u+=d.filename||d.name||c,c>30)break}e.push(u)}return e.push(t.userAgent),e.push(t.language||t.userLanguage||t.browserLanguage||""),e.push(t.doNotTrack||"0"),e.push(t.platform||"None"),e.join("")
},canvas:function(){var t=e.createElement("canvas");if("undefined"==typeof t.getContext)return!1;t.width=600,t.height=30,t.style.border="1px solid #3a3a3a";var r="English中文Հայերենا繁體輸入لعربيةҚазақша`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",n=t.getContext("2d"),i=n.createLinearGradient(0,0,200,0);return i.addColorStop(0,"rgb(200,0,0)"),i.addColorStop(.5,"rgb(0,200,0)"),i.addColorStop(1,"rgb(200,0,0)"),n.fillStyle=i,n.fillRect(0,0,200,30),n.fillStyle="#360",n.font="13px _sans",n.textBaseLine="top",n.fillText(r,5,18),n.beginPath(),n.strokeStyle="blue",n.lineWidth=5,n.shadowOffsetX=2,n.shadowOffsetY=2,n.shadowColor="rgb(85,85,85)",n.shadowBlur=3,n.arc(500,15,10,0,2*Math.PI,!0),n.stroke(),n.closePath(),t.toDataURL()+this.glinfo()
},glinfo:function(){var t=e.createElement("canvas");if("undefined"==typeof t.getContext)return!1;var r=null,n=["webgl","experimental-webgl","moz-webgl","webkit-3d"];try{for(var i=0;i<n.length&&null===r&&!(r=t.getContext(n[i],{width:600,height:300}));i++);return r.getParameter(r.RENDERER)+","+r.getParameter(r.VERSION)
}catch(a){}return""},init:function(){var t=r.os(),e=r.agent(),n=this.canvas(),i=[];i.push(this.murur_hash(t)),i.push(this.murur_hash(e)),n&&i.push(this.murur_hash(n));for(var a=[],o=0;o<i.length;o++)a.push(i[o].toString(36));return this.vid=a.join("-"),this.vid}};_.fingerprint=r.init()}catch(n){}}(),function(t){function e(t,e){for(var r=0,n=0;s>n;n++)r=131*r+t[e+n];
return r}function r(t){function r(t){if(u.push(t),u.length>a&&(u.shift(),c.shift()),u.length>=s){var r=u.length-s;c[r]=e(u,r)}}var n,i,u=[],c=[],d=0;this.n=function(){if(d<t.length-s+1){var a=e(t,d);n=0,i=0;for(var f=0;f<c.length;f++)if(a==c[f]){var p,l;for(p=f,l=d;p<u.length&&l<t.length&&!(u[p]!=t[l]||l-d>=o);p++,l++);p-f>=i&&p-f>=s&&(i=p-f,n=f)
}if(0==i){var h=[0,t[d]];return r(t[d++]),h}return d+=i,[i,u.length-(n+i)]}return d<t.length?[0,t[d++]]:!1}}function n(t){for(var e,r=[],n=-1;(e=t.n())!==!1;)if(0==e[0])(-1==n||255==r[n])&&(r.push(128),n=r.length-1),r.push(e[1]),r[n]++;else{n=-1,r.push(e[0]);var i=e[1];if(127>=i)r.push(i);else{for(var a=[];i>0;)a.push(127&i),i>>=7;
for(var o=a.length-1;o>=0;o--)r.push(128|a[o]);r[r.length-1]&=127}}n=0,this.n=function(){return n>=r.length?!1:r[n++]}}function i(t){var e=[],r=0;this.n=function(){if(r>0)return e[4-r--];var n=[t.n(),t.n(),t.n()];return n[0]===!1?!1:(e[0]=c(n[0]>>2),e[1]=c(n[1]===!1?n[0]<<4&63:63&(n[0]<<4|n[1]>>4)),e[2]=n[1]===!1?"~":c(n[2]===!1?n[1]<<2&63:63&(n[1]<<2|n[2]>>6)),e[3]=n[2]===!1?"~":c(63&n[2]),r=3,e[0])
}}var a=1024,o=63,s=3,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",c=function(t){return u.charAt(t)},d=function(t){for(var e,r=t.length,n=[],i=0;r>i;i++)e=t.charCodeAt(i),127>=e?n.push(e):2047>=e?(n.push(192|e>>6&31),n.push(128|63&e)):e>=55296&&57343>=e||(n.push(224|e>>12&15),n.push(128|e>>6&63),n.push(128|63&e));
return n};t.compress=function(t){if("string"!=typeof t||t.length<1)return t;for(var e,a=new r(d(t)),o=new n(a),s=new i(o),u=[];(e=s.n())!==!1;)u[u.length]=e;return u.join("")}}(S),n._count=0,n.prototype={constructor:n,init:function(t,e){"object"==typeof t&&("undefined"!=typeof t.page_id&&(this.data.pid=S.toint(t.page_id)),_.href="string"==typeof t.url?t.url:(n._count>1?"http://example.com/?url=":"")+location.href||"",("string"==typeof t.orderid||"number"==typeof t.orderid)&&(this.data.orderid=t.orderid),_.refer="string"==typeof t.refer?t.refer:p,t.isfront&&(_.refer=S.getRefer()),t.tid&&(this.data.tid=(""+t.tid).substring(0,30)),t.uid&&(this._duser.uid=t.uid),t.loginName&&(this._duser.loginName=t.loginName)),this.pvcallback=S.isFunction(e)?e:u
},readBfa:function(){var t,e,r=S.getItem("CTRIP_UBT_M",!0),n=S.getCookie("_bfa","",!0),i=!1;if(r&&r.create&&r.vid&&localStorage.removeItem("CTRIP_UBT_M"),n){var a=n.split(".");a.length>6&&(t=a)}if(t&&r&&r.vid?t[5]<r.sid_ts&&(i=!0):t||r&&r.vid&&(i=!0),i){var o=r.vid.split("."),s=1*o[0]||S.enter;t=[1,s,o[1],1,s,s,r.sid,r.pvid],this.data.ppi=r.pid,this.data.ppv=r.pvid
}else this.readBfi();if(!t){var s=S.enter,u=S.uniqueID().toString(36);t=[1,s,u,1,s,s,0,0],this.status.isnewvid=1}var c=S.getCookie("_bfs","",!0);this.status.isnewvid||!c?(e=[1,1],t[4]=t[5],t[5]=S.enter,t[6]=S.plus(t[6]),t[7]=S.plus(t[7]),this.status.isnewsid=1):(e=c.split("."),e[1]=S.plus(e[1]),t[7]=S.plus(t[7])),this.writBfa(t,e)
},writBfa:function(t,e){this.data.vid=t[1]+"."+t[2],this.data.sid=S.toint(t[6]),this.data.pvid=S.toint(t[7]),S.setCookie("_bfa",t.join("."),63072e6),S.setCookie("_bfs",e.join("."),18e5),this.updateUBT()},readBfi:function(){var t,e,r,n={};if(e=S.getCookie("_bfi","",!0)){t=e.split("&")||[];for(var i=0;i<t.length;i++)r=t[i].split("="),r.length>1&&(n[r[0]]=r[1])
}this.data.ppi=n&&n.p1?n.p1:0,this.data.ppv=n&&n.v1?n.v1:0},updateBfi:function(t){var e=this.data;t=t||e.pid;var r="p1="+t+"&p2="+e.ppi+"&v1="+e.pvid+"&v2="+e.ppv;S.setCookie("_bfi",r)},initUBT:function(){var t,e=0,r=0,n=0,i=0,a=S.getItem("CTRIP_UBT_M",!0);if(a&&a.vid&&a.create)t=a.vid,e=a.sid,r=S.plus(a.pvid),n=a.sid_ts,S.now()-n>c?(this.status.isnewsid=1,e=S.plus(e),this.data.ppi=0,this.data.ppv=0):(this.data.ppi=a.pid||0,this.data.ppv=a.pvid||0),a.refer&&(_.refer=a.refer),i=a.create;
else{var o=this.readOldBfa();o&&o.length>6?(t=o[1]+"."+o[2],e=S.plus(o[6]),r=S.plus(o[7])):(this.status.isnewvid=1,this.status.isnewsid=1,t=S.enter+"."+S.uniqueID().toString(36),e=1,r=1),i=S.enter}this.data.vid=t,this.data.sid=e,this.data.pvid=r,this.data.ubt={pid:this.getPid(),vid:t,sid:e,pvid:r,sid_ts:S.now(),create:i},this.updateUBT()
},updateUBT:function(t){v||g?("number"==typeof t&&(this.data.ubt.pid=t),S.setItem("CTRIP_UBT_M",this.data.ubt)):this.updateBfi(t)},readOldBfa:function(){var t=S.getCookie("_bfa","",!0);if(t||(t=S.getItem("_bfa")),t){var e=t.split(".");if(e.length>6){try{localStorage.removeItem("_bfa"),localStorage.removeItem("_bfs"),localStorage.removeItem("_bfi")
}catch(r){}return e}}return!1},getPid:function(){return this.data.pid||(this.data.pid=S.toint(S.$v("page_id"))),this.data.pid},getABtest:function(){for(var t=S.$("ab_testing_tracker"),r=[],n="";t;)n+=t.value,r.push(t),t.removeAttribute("id"),t.removeAttribute("name"),t=S.$("ab_testing_tracker"),n&&";"!=n[n.length-1]&&(n+=";");
for(var i=0;i<r.length;i++)r[i].setAttribute("id","ab_testing_tracker");var a="";return(a=e.location.hash)&&-1!==a.indexOf("abtest=")&&(n+=decodeURIComponent(a.replace(/.*(abtest=)/i,"").replace(/#.*/i,""))),n.substring(0,280)},get:function(t){if("string"!=typeof t)return"";switch(t){case"vid":case"sid":case"pvid":return this.data[t];
case"islogin":case"isnewvid":return this.status[t];case"fullpv":return this.data.vid+"."+this.data.sid+"."+this.data.pvid}},getCommon:function(){var t=[];return t[0]=this.getPid(),t[1]=this.data.vid,t[2]=this.data.sid,t[3]=this.data.pvid,t[4]=this.data.tid,t[5]=this.getABtest(),t[6]="",t[7]=o,t[8]=_.fingerprint,t[9]="",t[10]="",t
},getUinfo:function(){var t=this.getDatum(),r=[13],n="";try{n+="cl="+e.cookie.length,n+=",ckl="+(e.cookie.match(/[^=]+=[^;]*;?/g)||[]).length,n+=",lk="+localStorage.length}catch(i){}return _.href=(""+_.href).replace(/register\?phone=\d+/,"register?phone="),r[1]=this.data.ppi,r[2]=this.data.ppv,r[3]=_.href,r[4]=screen.width,r[5]=screen.height,r[6]=n,r[7]=_.lang,r[8]=t.engine,r[9]=t.keyword,r[10]=_.refer,r[11]=this.getABtest(),r[12]=this.status.isnewvid,r[13]=this.status.islogin,r[14]=t.user_id,r[15]=t.user_grade,r[16]=t.corpid,r[17]=t.start_city,r[18]=t.alliance_id,r[19]=t.alliance_sid,r[20]=t.alliance_ouid,r[21]=this.data.orderid,r[22]=t.duid,r[23]=t.zdata,r[24]=t.callid,r[25]=t.bid,r[26]=S.getItem("GUID"),r[27]=S.getItem("SOURCEID"),r[28]=t.appinfo,r[29]=v?"hybrid":"h5",r[30]=this.getDevicePix(),r[31]=this.status.isnewsid,r[32]=this.getOinfo(),r[33]="",r[34]="",r[35]="",r
},getDevicePix:function(){return"undefined"!=typeof t.devicePixelRatio?1*t.devicePixelRatio||1:1},getOinfo:function(){return JSON.stringify({lizard:this.getLizardData(),rg:S.getCookie("_RSG")})},getLizardData:function(){return"object"==typeof Lizard&&Lizard.selfCollection?Lizard.selfCollection||Lizard.version||"":""
},getDatum:function(){if(this.data.business)return this.data.business;var t=S.getCookieObj("Session"),e=S.getCookieObj("CtripUserInfo"),r=S.getCookieObj("StartCity_Pkg"),n=S.getCookie("DUID"),i=S.getCookieObj("Union");if(n)if(-1!=n.indexOf("v=")){var a,o;n.replace(/v=(\d+)/,function(t,e){o=e}).replace(/u=([^&]+)/,function(t,e){a=e
}),n="bbz_"+o+":"+a}else n="online:"+n;var s={engine:t&&t.SmartLinkCode||"",keyword:t&&t.SmartLinkQuary||"",start_city:r&&r.PkgStartCity||"",alliance_id:i&&i.AllianceID?i.AllianceID:"",alliance_sid:i&&i.SID?i.SID:"",alliance_ouid:i&&i.OUID?i.OUID:"",user_id:S.getCookie("login_uid",""),user_grade:e&&e.VipGrade||"",corpid:S.getCookie("corpid",""),duid:(n?n:e&&e.U)||"",zdata:S.getCookie("zdatactrip",""),callid:S.$v("bf_ubt_tl_callid")||"",bid:""};
try{if(!s.alliance_id){var u=S.getItem("UNION",!0);if(u&&u.data&&(u.st||u.timeout)){var c=0;c=u.st?+new Date(u.st):+new Date(u.timeout.replace(/-/g,"/")),i=u.data,c&&c>=S.enter&&(s.alliance_id=i.AllianceID||i.ALLIANCEID||"",s.alliance_sid=i.SID||"",s.alliance_ouid=i.OUID||"")}}}catch(d){}if("string"==typeof this._duser.uid&&(s.duid="custom:"+this._duser.uid.substring(0,50)),"string"==typeof this._duser.loginName&&(s.user_id=this._duser.loginName.substring(0,50)),!s.user_id&&!s.duid)try{var f=S.getItem("USER",!0);
if(f&&f.value){var p=f.value;s.user_id=p.LoginName||p.UserName||"",s.user_grade=p.VipGrade||"",s.duid=p.UserID||"",p.Auth&&(this.status.islogin=1)}}catch(d){}s.duid&&(this.status.islogin=1),this.data.tid||(this.data.tid=S.$v("CorrelationId")),this.parseOrderid();var l=S.getItem("CINFO",!0);if("object"==typeof l){var h={version:l.internalVersion||"",ver:l.version||"",net:l.networkStatus||"None",platform:l.platform||""};
s.appinfo=JSON.stringify(h)}else s.appinfo="";return this.data.business=s},parseOrderid:function(){if(!this.data.orderid){var t=S.getItem("PAYMENT2_ORDER_DETAIL",!0);t&&t.value&&(this.data.orderid=t.value.oid),this.data.orderid||(this.data.orderid=S.$v("bf_ubt_orderid"))}},sendPV:function(){function t(t){if(t){r.status.pv=!0,r.sendPS(),r.pvcallback(t);
var e=r.queue["default"];if(e)for(var n=0;n<e.length;n++){var i=e[n],a=r.dataHandler(i);a&&S.send(a,i.callback)}}else--_.rerun>0&&r.sendPV()}if(this.status.pvready)return!1;try{this.getDatum();var e={c:this.getCommon(!0),d:{uinfo:this.getUinfo()}},r=this;if(this.sendHybrid("uinfo",this.getUinfo()))t(!0);
else{var n="ac=g&d="+S.encode(JSON.stringify(e));S.send(n,t)}p=_.href.replace(/#.*/,""),this.updateUBT(this.getPid()),"function"==typeof this.pvreadyCallback&&this.pvreadyCallback(!1,this.getPid()),this.status.pvready=!0}catch(i){"function"==typeof this.pvreadyCallback&&this.pvreadyCallback(!1,this.getPid())
}},getPS:function(){for(var e=["navigationStart","redirectStart","unloadEventStart","unloadEventEnd","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],r=t.performance.timing,n=[6],i=0;i<e.length;i++)n.push(r[e[i]]);
return n.push(t.performance.navigation.type||0),n.push(t.performance.navigation.redirectCount||0),n},sendPS:function(){function e(){if(t.performance.timing.loadEventEnd&&n.getPid()){var i={c:n.getCommon(),d:{ps:n.getPS()}};if(!n.sendHybrid("ps",n.getPS())){var a="ac=g&d="+S.encode(JSON.stringify(i));
S.send(a)}return n.status.ps=!0}300>r&&(r++,setTimeout(e,1e3))}if(t.performance&&!this.status.ps){var r=0,n=this;try{e()}catch(i){}}},replaceParam:function(t){var e=this.getDatum(),r={duid:e.duid,page_id:this.getPid(),is_login:this.status.islogin},n=t.replace(y,function(t,e){return e in r?r[e]:t});return n
},dataHandler:function(t){if("string"==typeof t)return t;if("object"==typeof t){if(t.c&&t.d){for(var e in t.d)if(this.sendHybrid(e,t.d[e]))return!1;var r={c:this.getCommon(),d:t.d};return"ac=g&d="+S.encode(JSON.stringify(r))}if(t.k&&t.v){var n=this.getDatum(),i=this.replaceParam(t.v),a=S.getItem("GUID");
if(this.sendHybrid("t",{key:t.k,val:i,duid:n.duid,clientid:a,env:"hybrid",v:6}))return!1;i=S.encode(i);var o=v?"hybrid":"h5";return"ac=tl&pi="+this.getPid()+"&key="+t.k+"&val="+i+"&pv="+this.get("fullpv")+"&duid="+n.duid+"&v=6&env="+o+"&c="+a}}},sendData:function(t){if(this.status.pv){var e=this.dataHandler(t);
e&&S.send(e,t.callback)}else this.queuePush("default",t)},queuePush:function(t,e){this.queue[t]||(this.queue[t]=[]),this.queue[t].push(e),this.queueCheck(!1,t)},queueCheck:function(t,e){if(!this.status.pv||"default"==e)return!1;var r=this.queue[e];if(r){var n=r.length;if(n>5||t&&n>0){var i=r.splice(0,5),a=[[1,e],this.getCommon(),i];
this.queueSend(a)}}},queueSend:function(t){if(!this.sendHybrid(t[0][1],t[2])){var e="";try{e=S.compress(JSON.stringify(t))}catch(r){}if(e){var n="ac=a&d="+e;S.send(n)}}},getCommonObj:function(){var t=this.getCommon();return{pid:t[0],vid:t[1],sid:t[2],pvid:t[3],ver:o,ifr:0}},pack:function(t,e){if("restiming"!==e)return!1;
var r=JSON.parse(JSON.stringify(t));if(r.ifr=0,r.t=S.now(),!this.sendHybrid(e,r)){var t=[[1,"ctrip"],this.getCommonObj(),[[["ubt",e,1],t]]],n="a=z&d="+S.compress(JSON.stringify(t))+"&t="+S.now();S.send(n)}},sendHybrid:function(e,r){if(!_.tcpReady){if(!v||!t.CtripBusiness||"function"!=typeof CtripBusiness.app_track_UBT_JS_log)return!1;
if(!/(iphone|ipod|ipad)/i.test(t.navigator.userAgent)&&(!m||/^(6\.11|6\.12)/.test(m)))return!1}var n,i=this.getCommon();switch(i[9]=navigator.userAgent,e){case"uinfo":n=99;break;default:n=6}var a={c:i,dataType:e,priority:n,d:r};return this._sendHybridF(a),!0},_sendHybridF:function(t){if(!_.tcpReady){if(!Internal||!Internal.osVersion)return t&&k.push(t),void setTimeout(this._sendHybridF,500);
for(var e=0,r=k.length;r>e;e++)CtripBusiness.app_track_UBT_JS_log("ubt_js_sdk",k[e]);k=[],_.tcpReady=!0}t&&CtripBusiness.app_track_UBT_JS_log("ubt_js_sdk",t)},destroy:function(){this.queueCheck(!0,"useraction"),this.queueCheck(!0,"matrix"),this.status.destroyed=!0},ready:function(){S.isReady&&this.sendPV()
}};var C=new n;!function(){function e(t){var e=S.keys(t),r=e.length;if(r>i)return i;for(var n=0;r>n;n++){var a=t[e[n]];if("string"==typeof a)t[e[n]]=a.substring(0,o);else if("number"!=typeof a)return 110}return 1}function r(t){if("number"==typeof t)return!0;if("object"==typeof t){var e=S.keys(t),r=e.length;
if(r>30)return!1;for(var n=/^([a-zA-Z0-9_.]){1,30}$/,i=0;r>i;i++){var a=e[i],o=t[a];if("string"!=typeof a||!n.test(a)||"number"!=typeof o)return!1}return!0}return!1}var i=8,o=300,s=!1,c={},d={_config:function(t,e,r){switch(t){case"markting":_.markting=!!e}r&&r(e)},_setDebug:function(t){t&&(_.debug=!0,_.surl="http://localhost")
},_setEnv:function(t){"string"==typeof t&&S.initEnv(t)},_getFullPV:function(t){var e=C.get("fullpv");return t&&S.isFunction(t)&&t(e),e},_getStatus:function(t){var e={vid:C.get("vid"),sid:C.get("sid"),pvid:C.get("pvid"),pid:C.getPid(),abtest:C.getABtest(),pv:C.status.pv,ps:C.status.ps};return t&&S.isFunction(t)&&t(e),e
},_unload:function(t){return("undefined"!=typeof $&&$.bindFastClick||"object"==typeof Lizard)&&1==f?void(f=0):("object"==typeof CtripBusiness&&CtripBusiness.app_send_ubt_log&&CtripBusiness.app_send_ubt_log({page:C.getPid(),vid:C.get("vid"),sid:C.get("sid"),pvid:C.get("pvid"),ts:S.now()}),"object"!=typeof t&&(t={}),void(C.status.pvready?(C.destroy(),C=new n):(C.init(t),C.sendPV(),C.destroy(),C=new n)))
},_set:function(t,e,r){switch(r=r||u,t){case"uid":C._duser.uid=e;break;case"loginName":C._duser.loginName=e;break;default:return r(0)}return r(e)},_asynRefresh:function(t,e){C.status.pvready?(C.destroy(),C=new n(t||{},e),C.sendPV()):(C.init(t,e),C.sendPV())},_tracklog:function(t,e,r){return e&&"string"==typeof e&&"string"==typeof t?void C.sendData({k:t,v:e,callback:r}):(S.isFunction(r)&&r(0),!1)
},_trackError:function(t,e){if("object"!=typeof t)return!1;if(s)return s=!1,!1;t.skip===!0&&(s=!0);for(var r=["version","message","line","file","category","framework","time","repeat","islogin","name","column"],n=[7,"",0,"","","",S.now()-S.enter,1,C.get("islogin"),"",0],i=1,a=r.length;a>i;i++){var o=r[i];
if(t[o]){var u=t[o]+"";switch(o){case"message":case"file":u=u.substring(0,500);break;case"category":case"framework":case"name":u=u.substring(0,100);break;case"time":u=parseInt(u,10);break;case"column":u=parseInt(u,10);break;default:u=parseInt(u,10)||0}n[i]=u}}n.push(t.stack?S.isArray(t.stack)?t.stack.join("").slice(-1600):String(t.stack).slice(-1600):""),C.sendData({c:!0,d:{error:n},callback:e})
},_trackUserBlock:function(t,e){if("object"!=typeof t)return!1;var r=[];r[0]=6,r[1]=C.get("islogin"),r[2]=String(t.message||"").substring(0,300),r[3]=String(t.value||"").substring(0,300),r[4]=String(t.type||"").substring(0,50),r[5]=String(t.dom||"").substring(0,100),r[6]=String(t.form||"").substring(0,100),r[7]=S.toint(t.count||0,10),C.sendData({c:!0,d:{ub:r},callback:e})
},_trackMetric:function(t,r){var n=0;if(r=r||C,"object"==typeof t){var i=S.extend({name:"",tag:{},value:0,ts:S.now(),callback:u,timeout:!1,sample:100},t);if(!S.notChosen(i.sample)){if("string"==typeof i.name&&"object"==typeof i.tag&&"number"==typeof i.value&&1==(n=e(i.tag))){var a={name:i.name,tags:i.tag,value:i.value,ts:i.ts};
if("number"==typeof i.timeout){var o=[[1,"matrix"],r.getCommon(),[a]];S.send("ac=a&d="+S.compress(JSON.stringify(o)),function(){S.isFunction(i.callback)&&100!==n&&i.callback(n),n=100})}else r.queuePush("matrix",a)}if(S.isFunction(i.callback)){var s="number"==typeof i.timeout?i.timeout:50;setTimeout(function(){100!==n&&i.callback(n),n=100
},s)}}}},_trackMatrix:function(t,n,i,a,o){a="number"==typeof a?a:S.now();var s=0;"string"!=typeof t&&"number"!=typeof t||"object"!=typeof n||1==(s=e(n))&&r(i)&&C.queuePush("matrix",{name:t,tags:n,value:i,ts:a}),S.isFunction(o)&&o(s)},_time:function(t,e){if("string"!=typeof t)throw new TypeError("[time]name must be a string.");
c[t]={value:S.now(),options:e||{},pv:C}},_timeEnd:function(t,e){if("string"!=typeof t)throw new TypeError("[timeEnd]name must be a string.");var r=c[t];if(r&&r.value){var n=S.now()-r.value,i=S.extend(r.options,e||{});if(i.name)return i.value=n,d._trackMetric(i,r.pv),delete c[t],n}},_getFP:function(t){return t&&S.isFunction(t)?(t(_.fingerprint),!0):!1
},_getPageid:function(t){C.status.pvready?t(!1,C.getPid()):C.pvreadyCallback=t},_require:function(t,e){switch(t){case"markting":return a(e)}},push:function(t){var e;if(S.isArray){var e=t[0];if("_"==e[0]&&S.isFunction(d[e]))return d[e].apply(d,t.slice(1))}return!1}};if(S.isArray(t.__bfi)){var p=t.__bfi,l=p.length;
if(l>0)for(var h=0;l>h;h++)d.push(p[h])}else t.__bfi=[];t.__bfi.push=d.push,S.extend(t.$_bf,{_getFullPV:d._getFullPV,_getStatus:d._getStatus,tracklog:d._tracklog,trackError:d._trackError,asynRefresh:d._asynRefresh})}();var w=null;if(i(),function(r){function n(t){u=t.touches&&t.touches[0]||t,h=!1,l=!0
}function i(t){if(l){var e=t.touches&&t.touches[0]||t,r=0,n=0;r=Math.abs(e.pageX-u.pageX),n=Math.abs(e.pageY-u.pageY),h=6>r||6>n?!1:!0}}function a(t){!h&&l&&o(t),l=!1}function o(t){var n=t.target||t.srcElement,i=n.nodeName.toUpperCase();if(n.getBoundingClientRect){var a,o,c=n.getBoundingClientRect(),d="",f=Math.max(s.scrollLeft,e.body.scrollLeft)||0,p=Math.max(s.scrollTop,e.body.scrollTop)||0,l=u.pageX||t.pageX||0,h=u.pageY||t.pageY||0,g=parseInt((s.clientWidth||e.body.clientWidth)/2,10);
"SELECT"==i&&h-c.top-p<0?(d+="[@x='"+parseInt(l+c.left+f-g,10)+"'][@y='"+parseInt(h+c.top,10)+"']",a=l,o=h-p):(d+="[@x='"+(l-g)+"'][@y='"+h+"']",a=parseInt(l-c.left-f,10)||0,o=parseInt(h-c.top-p,10)||0),a>=0&&o>=0&&a<=screen.width+f&&(d+="[@rx='"+a+"']",d+="[@ry='"+o+"']",C.queuePush("useraction",{action:"click",xpath:r.getXpath(n)+d,ts:r.now()}))
}}var u,c="ontouchstart"in t,d=c?"touchstart":"mousedown",f=c?"touchmove":"mousemove",p=c?"touchend":"mouseup",l=!1,h=!1;e.addEventListener(d,n,!0),e.addEventListener(f,i,!0),e.addEventListener(p,a,!0)}(S),null===t.onerror){var E={};t.onerror=function(){try{var t=arguments,e=[],r=t[4];"string"==typeof r?e=r.split("\n"):"object"==typeof r&&r.stack&&(e=r.stack.split("\n"));
var n={message:""+t[0],file:""+t[1],category:"inner-error",framework:"normal",time:S.now()-S.enter,line:t[2],column:t[3],stack:e,repeat:1},i="err_"+S.hash(n.message+n.file+n.line);E[i]||(__bfi.push(["_trackError",n]),E[i]=!0)}catch(a){}}}!function(){function r(t){if("string"!=typeof t)return"";for(var e=i.exec(t),r={},n=14;n--;)e[n]&&(r[a[n]]=e[n]);
return r}function n(){return navigator.connection&&navigator.connection.type||"null"}if(!S.notChosen(5))try{for(var i=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,a=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],o=/^(file|chrome|asset)|\.(baidu|ctrip|google|bdimg|xiecheng|amap|tieyou|c-ctrip|ctripcorp|hhtravel)\./,s=e.scripts,u=s.length,c=0;u>c;c++){var d=s[c];
if(d.src&&!o.test(d.src)){{r(d.src)}__bfi.push(["_trackMatrix","ubt.hijack",{type:"script",url:d.src,net:n()},1])}}if(t.top!==t&&t.length>0&&t.top.location.href){var f=t.top.location.href||"";o.test(f)||__bfi.push(["_trackMatrix","ubt.hijack",{type:"iframe",url:f,net:n()},1])}}catch(p){}}(),function(){function e(t){for(var e=0,r=0;r<t.length;r++)t.charCodeAt(r)>127||94==t.charCodeAt(r)?e+=2:e++;
return e}var r=C.data.pvid||0;if(!S.notChosen(1)&&r%10==5)try{var n,i,a,o,s=/(hotel|matrix|flight|train|gs|payment2|tuan|diyshx|diyfhx|diy|diyfhxsdp|bus|vacations|tour|grouptravel|ticket|car|cruise|hhtravel|shopping|wallet)[\-\_]/,u=t.localStorage,c={},d=0;for(n in u)i=n.toLowerCase(),s.test(i)&&(a=RegExp.$1,o=e(u[n]),c[a]||(c[a]=0),c[a]+=o,d+=o);
if(d){var f="all="+d;for(a in c)f+="&"+a+"="+c[a];__bfi.push(["_tracklog","ubt_m_localstorage",f])}}catch(p){}}(),setTimeout(function(){var t=S.$v("bf_ubt_markting_off");_.markting=t&&"false"!=t?!1:_.markting,!g&&/^(http\:|https\:)$/.test(_.protocol)&&(S.loadScript({mask:"yyyymmdd"},"//webresource.c-ctrip.com/resaresonline/risk/ubtrms/latest/default/mrms.js"),_.markting&&a())
},50),function(){function e(t){if("string"!=typeof t)return"";for(var e=i.exec(t),r={},n=14;n--;)e[n]&&(r[a[n]]=e[n]);return r}function r(t){return 0==t.connectStart||t.connectEnd-t.connectStart<6||t.responseEnd-t.responseStart<6||t.domainLookupStart==t.domainLookupEnd&&t.domainLookupEnd==t.fetchStart&&t.fetchStart==t.connectStart&&t.fetchStart==t.connectEnd?!0:!1
}if(!(v||S.hash(C.data.vid)%100>10&&-480==(new Date).getTimezoneOffset()))try{if("performance"in t&&"getEntriesByType"in t.performance&&t.performance.getEntriesByType("resource")instanceof Array){var n={"download.ctrip.com":!0,"images4.c-ctrip.com":!0,"webresource.c-ctrip.com":!0,"dimg04.c-ctrip.com":!0,"dimg02.c-ctrip.com":!0,"youresource.c-ctrip.com":!0,"mubt.test.sh.ctriptravel.com":!0},i=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,a=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"];
t.addEventListener("load",function(){for(var i=t.performance.getEntriesByType("resource"),a=i.length,o=[],s=0;a>s;s++){var u=i[s],c=e(u.name);if("string"==typeof c.host&&n[c.host]&&!r(u)){var d=u.name;if(o.push({entryType:u.entryType||"",initiatorType:u.initiatorType||"",name:d,nextHopProtocol:"",startTime:u.startTime||0,redirectStart:u.redirectStart||0,redirectEnd:u.redirectEnd||0,fetchStart:u.fetchStart||0,domainLookupStart:u.domainLookupStart||0,domainLookupEnd:u.domainLookupEnd||0,connectStart:u.connectStart||0,connectEnd:u.connectEnd||0,secureConnectionStart:u.secureConnectionStart||0,requestStart:u.requestStart||0,responseStart:u.responseStart||0,responseEnd:u.responseEnd||0,transferSize:u.transferSize||0,encodedBodySize:u.encodedBodySize||0,decodedBodySize:u.decodedBodySize||0}),o.length>2)break
}}o.length>0&&C.pack(o,"restiming")})}}catch(o){}}()}catch(I){}}(window,document);